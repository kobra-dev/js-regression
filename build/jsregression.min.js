var jsregression={};(function(a){'use strict';var b=function(a){a=a||{},a.iterations||(a.iterations=1e3),a.alpha||(a.alpha=.001),a.lambda||(a.lambda=0),a.trace||(a.trace=!1),this.iterations=a.iterations,this.alpha=a.alpha,this.lambda=a.lambda,this.trace=a.trace};b.prototype.fit=function(a){var b=a.length,c=[],e=[];this.dim=a[0].length;for(var f=0;f<b;++f){var g=a[f],h=[],l=g[g.length-1];h.push(1);for(var m=0;m<g.length-1;++m)h.push(g[m]);e.push(l),c.push(h)}this.theta=[];for(var n=0;n<this.dim;++n)this.theta.push(0);for(var o,p=0;p<this.iterations;++p){o=this.grad(c,e,this.theta);for(var n=0;n<this.dim;++n)this.theta[n]-=this.alpha*o[n];this.trace&&console.log("cost at iteration "+p+": "+this.cost(c,e,this.theta))}return{theta:this.theta,dim:this.dim,cost:this.cost(c,e,this.theta),config:{alpha:this.alpha,lambda:this.lambda,iterations:this.iterations}}},b.prototype.grad=function(a,b,c){for(var e,f=a.length,h=[],j=0;j<this.dim;++j){e=0;for(var k=0;k<f;++k){var l=a[k],m=b[k],n=this.h(l,c);e+=(n-m)*l[j]}e=(e+this.lambda*c[j])/f,h.push(e)}return h},b.prototype.h=function(a,b){for(var c=0,e=0;e<this.dim;++e)c+=a[e]*b[e];return c},b.prototype.cost=function(a,b,c){for(var e=a.length,f=0,g=0;g<e;++g){var h=a[g],j=this.h(h,c);f+=(j-b[g])*(j-b[g])}for(var k=0;k<this.dim;++k)f+=this.lambda*c[k]*c[k];return f/(2*e)},b.prototype.transform=function(a){if(a[0].length){for(var b,c=[],d=0;d<a.length;++d)b=this.transform(a[d]),c.push(b);return c}for(var e=[1],f=0;f<a.length;++f)e.push(a[f]);return this.h(e,this.theta)},a.LinearRegression=b;var c=function(a){var a=a||{};a.alpha||(a.alpha=.001),a.iterations||(a.iterations=100),a.lambda||(a.lambda=0),this.alpha=a.alpha,this.lambda=a.lambda,this.iterations=a.iterations};c.prototype.fit=function(a){this.dim=a[0].length;for(var b=a.length,c=[],e=[],f=0;f<b;++f){var g=a[f],h=[],k=g[g.length-1];h.push(1);for(var l=0;l<g.length-1;++l)h.push(g[l]);c.push(h),e.push(k)}this.theta=[];for(var m=0;m<this.dim;++m)this.theta.push(0);for(var n,o=0;o<this.iterations;++o){n=this.grad(c,e,this.theta);for(var m=0;m<this.dim;++m)this.theta[m]-=this.alpha*n[m]}return this.threshold=this.computeThreshold(c,e),{theta:this.theta,threshold:this.threshold,cost:this.cost(c,e,this.theta),config:{alpha:this.alpha,lambda:this.lambda,iterations:this.iterations}}},c.prototype.computeThreshold=function(a,b){for(var c,d=1,e=a.length,f=0;f<e;++f)c=this.transform(a[f]),1==b[f]&&d>c&&(d=c);return d},c.prototype.grad=function(a,b,c){for(var e,f=a.length,g=[],h=0;h<this.dim;++h){e=0;for(var j=0;j<f;++j){var k=a[j],l=this.h(k,c);e+=((l-b[j])*k[h]+this.lambda*c[h])/f}g.push(e)}return g},c.prototype.h=function(a,b){for(var c=0,e=0;e<this.dim;++e)c+=b[e]*a[e];return 1/(1+Math.exp(-c))},c.prototype.transform=function(a){if(a[0].length){for(var b,c=[],d=0;d<a.length;++d)b=this.transform(a[d]),c.push(b);return c}for(var e=[1],f=0;f<a.length;++f)e.push(a[f]);return this.h(e,this.theta)},c.prototype.cost=function(a,b,c){for(var e=a.length,f=0,g=0;g<e;++g){var h=b[g],j=a[g];f+=-(h*Math.log(this.h(j,c))+(1-h)*Math.log(1-this.h(j,c)))/e}for(var k=0;k<this.dim;++k)f+=this.lambda*c[k]*c[k]/(2*e);return f},a.LogisticRegression=c;var d=function(a){var a=a||{};a.alpha||(a.alpha=.001),a.iterations||(a.iterations=100),a.lambda||(a.lambda=0),this.alpha=a.alpha,this.lambda=a.lambda,this.iterations=a.iterations};d.prototype.fit=function(b,d){this.dim=b[0].length;var e=b.length;if(!d){d=[];for(var f=0;f<e;++f){for(var g=!1,h=b[f][this.dim-1],l=0;l<d.length;++l)if(h==d[l]){g=!0;break}g||d.push(h)}}this.classes=d,this.logistics={};for(var m,n={},o=0;o<this.classes.length;++o){m=this.classes[o],this.logistics[m]=new a.LogisticRegression({alpha:this.alpha,lambda:this.lambda,iterations:this.iterations});for(var p,q=[],f=0;f<e;++f){p=[];for(var l=0;l<this.dim-1;++l)p.push(b[f][l]);p.push(b[f][this.dim-1]==m?1:0),q.push(p)}n[m]=this.logistics[m].fit(q)}return n},d.prototype.transform=function(a){if(a[0].length){for(var b,d=[],e=0;e<a.length;++e)b=this.transform(a[e]),d.push(b);return d}for(var f=0,g="",h=0;h<this.classes.length;++h){var j=this.classes[h],c=this.logistics[j].transform(a);f<c&&(f=c,g=j)}return g},a.MultiClassLogistic=d})(jsregression);export default jsregression;
